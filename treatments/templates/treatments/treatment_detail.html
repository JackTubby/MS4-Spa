{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'treatments/css/treatments.css' %}">
{% endblock %}


{% block page_header %}
<div class="container header-container">
    <div class="row">
        <div class="col"></div>
    </div>
</div>
{% endblock %}
    {{ treatment.image.url }}
    {{ treatment.name }}
    {% if treatment.category %}
    {{ treatment.category.friendly_name }}
    {% endif %}
    {% if treatment.amount %}
    {{ treatment.amount }}
    {% endif %}
    {{ treatment.price }}
    {{ treatment.description }}
    {{ current_rating }}

{% block content %}
{% include 'includes/main-nav.html' %}
<main id="treatment-details-main">
    <div class="container page-height page-padding">
        <div class="row text-center">
            <div class="col-12 col-lg-6">
                <div class="logoarea pt-5 pb-5">
                    <img class="treatment-d-img" src="../../../media/spa.jpg" alt="">
                </div>
            </div>
            <div class="col-12 col-lg-6">
                <h2 class="pb-3 cart-text">{{ treatment.name }}</h2>
                <hr>
                <p class="pb-3 cart-text">{{ treatment.price }}</p>
                {% if rating_count > 0 %}
                <p class="pb-3 cart-text"><i class="fas fa-smile"></i> {{ current_rating }}/5.0</p>
                {% endif %}
                <p class="pb-3 cart-text">{{ treatment.description }}</p>
                <!-- Quantity -->
                <form class="form-inline" action="{% url 'add_to_cart' treatment.id %}" method="POST">
                    {% csrf_token %}
                    <div class="col-6 cart-text">
                        Quantity
                    </div>
                    <div class="col-6">
                        <input class="form-control qty_input" type="number"
                            name="quantity" value="1" min="1" max="99"
                            data-item_id="{{ treatment.id }}"
                            id="id_qty_{{ treatment.id }}">
                    </div>
                    <hr class="pb-5">
                    <!-- Add to cart btn -->
                    <div class="col-12">
                        <button class="btn fill-btn add-cart-btn">
                            <input type="submit" class="btn" value="">
                            Add To Cart
                        </button>
                    </div>
                    <input type="hidden" name="redirect_url" value="{{ request.path }}">
                </form>
            </div>
        </div>
        <!-- Ratings -->
        <div class="rating-wrapper">
            <div class="col-lg-12">
                <div class="row">
                    <div class="col-12">
                        <div>
                            <h5>Ratings</h5>
                            {% if current_rating %}
                               <h5><i class="fas fa-star mr-1"></i>{{current_rating}} / 5.0</h5>
                               <p>({{rating_count}} Ratings)</p>
                            {% else %}
                                <small class="text-muted">This Treatment has no Rating!</small>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <hr>
                <div class="row">
                    {% if rating_obj%}
                        {% for rating in rating_obj%}
                            {% if rating.treatment_id == treatment.id%}
                            <div class="col-2">
                                <div><h6><i class="fa fa-user-o"></i> {{rating.user}}</h6></div>
                                <div><p><i class="fa fa-clock-o"></i> {{rating.time_added}}</p></div>
                                    <div class="pull-right">
                                    {%if rating.rate == 1%}
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star-o empty"></i>
                                        <i class="fa fa-star-o empty"></i>
                                        <i class="fa fa-star-o empty"></i>
                                        <i class="fa fa-star-o empty"></i>
                                        {%elif rating.rate == 2%}
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star-o empty"></i>
                                        <i class="fa fa-star-o empty"></i>
                                        <i class="fa fa-star-o empty"></i>
                                        {%elif rating.rate == 3%}
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star-o empty"></i>
                                        <i class="fa fa-star-o empty"></i>
                                        {%elif rating.rate == 4%}
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star-o empty"></i>
                                        {%elif rating.rate == 5%}
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                    {% endif%}
                                </div>
                            </div>
                            {%endif%}
                        {% endfor %}
                    {%endif%}
                </div>
            </div>
        </div>
    </div>
</main>
{% include 'includes/footer.html' %}
{% endblock %}

{% block postloadjs %}
{{ block.super }}
{% include 'treatments/includes/quantity_input_script.html' %}
<script type="text/javascript">
    // Updates date inputs to todays date
    document.getElementById('date').valueAsDate = new Date();
</script>
{% endblock %}